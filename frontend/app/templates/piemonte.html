{% extends 'base.html' %}

{% block title %} Piemonte - H-Farm Group Project {% endblock %}

{% block content %}
<div class="container-fluid mt-5 mb-5">
    <h1>Welcome to Piemonte</h1>
    <p>Advanced Filtering:</p>
    <form method="get" action="{{ url_for('piemonte') }}">
        <div class="form-row">
            <div class="form-group col-md-2">
                <input type="number" class="form-control" name="bagni" placeholder="Bagni">
            </div>
            <div class="form-group col-md-2">
                <input type="number" class="form-control" name="camere" placeholder="Camere">
            </div>
            <div class="form-group col-md-2">
                <input type="number" class="form-control" name="letti" placeholder="Letti">
            </div>
            <div class="form-group col-md-3">
                <input type="text" class="form-control" name="provincia" placeholder="Provincia">
            </div>
            <div class="form-group col-md-3">
                <input type="text" class="form-control" name="comune" placeholder="Comune">
            </div>
            <div class="form-group col-md-3">
                <input type="text" class="form-control" name="location" placeholder="🗺️ Enter a location">
            </div>
            <div class="form-group col-md-2">
                <select class="form-control" name="range_km">
                    <option value="5.0">5 KM</option>
                    <option value="10.0">10 KM</option>
                    <option value="20.0">20 KM</option>
                    <option value="50.0">50 KM</option>
                    <option value="80.0">80 KM</option>
                    <option value="100.0">100 KM</option>
                </select>
            </div>
        </div>
        <button type="submit" class="btn btn-primary mt-4">Apply Filters</button>
    </form>

    <!-- Progress Bar -->
    <div class="progress mt-3" style="height: 25px;">
        <div id="progress-bar" class="progress-bar" role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">0%</div>
    </div>

    <!-- Displaying mountain shelters -->
    <div class="row mt-5">
        {% for item in cleaned_data %}
            <div class="col-md-4 mb-4">
                <div class="card h-100">
                    <div class="card-body">
                        <h5 class="card-title">{{ item['DENOMINAZIONE'] }}</h5>
                        <p>
                            <strong>Provincia:</strong> {{ item['PROVINCIA'] }}<br>
                            <strong>Comune:</strong> {{ item['COMUNE'] }}<br>
                            <strong>Indirizzo:</strong> {{ item['INDIRIZZO'] }}<br>
                            <strong>Telefono:</strong> {{ item['TELEFONO'] }}<br>
                            <strong>Camere:</strong> {{ item['CAMERE'] }}<br>
                            <strong>Letti:</strong> {{ item['LETTI'] }}<br>
                            <strong>Bagni:</strong> {{ item['BAGNI'] }}<br>
                            <strong>Description:</strong> {{ item['Description'] }}<br>
                            <strong>Coordinates:</strong> {{ item['Latitude'] }}, {{ item['Longitude'] }}<br>
                        </p>
                    </div>         
                </div>
            </div>
        {% endfor %}
    </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', (event) => {
    const form = document.querySelector('form');
    const progressBar = document.getElementById('progress-bar');

    form.addEventListener('submit', function (e) {
      let width = 0;
      const interval = setInterval(function() {
        if (width >= 100) {
          clearInterval(interval);
        } else {
          width++;
          progressBar.style.width = width + '%';
          progressBar.textContent = width + '%';
        }
      }, 100); // Adjust the time interval as needed
    });
  });
</script>

{% endblock %}