{% extends 'base.html' %}

{% block title %} Piemonte - H-Farm Group Project {% endblock %}

{% block content %}
<div class="container-fluid mt-5 mb-5">
    <h1>Welcome to Piemonte</h1>
    <p>Advanced Filtering:</p>
    <form method="get" action="{{ url_for('piemonte') }}">
        <div class="form-row">
            <div class="form-group col-md-2">
                <input type="number" class="form-control" name="bagni" placeholder="Bagni">
            </div>
            <div class="form-group col-md-2">
                <input type="number" class="form-control" name="camere" placeholder="Camere">
            </div>
            <div class="form-group col-md-2">
                <input type="number" class="form-control" name="letti" placeholder="Letti">
            </div>
            <div class="form-group col-md-3">
                <input type="text" class="form-control" name="provincia" placeholder="Provincia">
            </div>
            <div class="form-group col-md-3">
                <input type="text" class="form-control" name="comune" placeholder="Comune">
            </div>
        </div>
        <button type="submit" class="btn btn-primary mt-4">Apply Filters</button>
    </form>

    <!-- Displaying mountain shelters -->
    <div class="row mt-5">
        {% for item in cleaned_data %}
            <div class="col-md-4 mb-4">
                <div class="card h-100">
                    <div class="card-body">
                        <h5 class="card-title">{{ item['DENOMINAZIONE'] }}</h5>
                        <p>
                            <strong>Provincia:</strong> {{ item['PROVINCIA'] }}<br>
                            <strong>Comune:</strong> {{ item['COMUNE'] }}<br>
                            <strong>Indirizzo:</strong> {{ item['INDIRIZZO'] }}<br>
                            <strong>Telefono:</strong> {{ item['TELEFONO'] }}<br>
                            <strong>Camere:</strong> {{ item['CAMERE'] }}<br>
                            <strong>Letti:</strong> {{ item['LETTI'] }}<br>
                            <strong>Bagni:</strong> {{ item['BAGNI'] }}<br>
                        </p>

                        {% set shelter_info = fetch_shelter_info(item['DENOMINAZIONE']) %}
                        <strong>Trail Info:</strong>
                        {% if shelter_info.data.Description is defined %}
                            {{ shelter_info.data.Description }}
                        {% else %}
                            ðŸ’€ Trail info not found!
                        {% endif %}
                        <br>
                        <strong>Coordinates:</strong>
                        {% if shelter_info.data.Latitude is defined and shelter_info.data.Longitude is defined %}
                            {{ shelter_info.data.Latitude }}, {{ shelter_info.data.Longitude }}
                        {% else %}
                            ðŸ’€ Coordinates not found!
                        {% endif %}
                        <br>           
                    </div>         
                </div>
            </div>
        {% endfor %}
    </div>
</div>
{% endblock %}